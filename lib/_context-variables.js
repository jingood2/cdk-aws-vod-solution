"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ContextVariables = void 0;
const cdk = require("@aws-cdk/core");
const convertToBool = (value) => {
    if (value === undefined || !value) {
        return null;
    }
    switch (value) {
        case true:
        case 'true':
        case 1:
        case '1':
        case 'on':
        case 'yes':
            return true;
        default:
            return false;
    }
};
class ContextVariables extends cdk.Construct {
    constructor(scope, id, props) {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j;
        super(scope, id);
        this.acceleratedTranscoding = (_a = this.node.tryGetContext('acceleratedTranscoding')) !== null && _a !== void 0 ? _a : 'PREFERRED';
        if (this.acceleratedTranscoding === undefined) {
            throw new Error(`The 'acceleratedTranscoding' context variable is required.`);
        }
        if (this.acceleratedTranscoding &&
            !['DISABLED', 'ENABLED', 'PREFERRED'].includes(this.acceleratedTranscoding)) {
            throw new Error(`The 'acceleratedTranscoding' context variable must be one of 'DISABLED', 'ENABLED', or 'PREFERRED'; found value was '${this.acceleratedTranscoding}'.`);
        }
        this.adminEmail = this.node.tryGetContext('adminEmail');
        if (this.adminEmail === undefined) {
            throw new Error(`The 'adminEmail' context variable is required.`);
        }
        const adminEmailValidation = this.adminEmail.match(/^[_A-Za-z0-9-\\+]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})$/g);
        if (adminEmailValidation && adminEmailValidation.length !== 1) {
            throw new Error(`The 'adminEmail' context variable must be a valid email address and must contain only one email; found value was '${this.adminEmail}'.`);
        }
        this.prependDomainWithStackStage = (_b = this.node.tryGetContext('prependDomainWithStackStage')) !== null && _b !== void 0 ? _b : false;
        this.cloudFrontDomain =
            this.node.tryGetContext('cloudFrontDomain') !== undefined
                ? !this.prependDomainWithStackStage &&
                    this.node.tryGetContext('stackStage') !== undefined
                    ? this.node.tryGetContext('cloudFrontDomain')
                    : `${this.node.tryGetContext('stackStage').toLowerCase()}.${this.node.tryGetContext('cloudFrontDomain')}`
                : undefined;
        this.enableMediaPackage = (_c = convertToBool(this.node.tryGetContext('enableMediaPackage'))) !== null && _c !== void 0 ? _c : false;
        this.enableSns = (_d = convertToBool(this.node.tryGetContext('enableSns'))) !== null && _d !== void 0 ? _d : false;
        this.enableSqs = (_e = convertToBool(this.node.tryGetContext('enableSqs'))) !== null && _e !== void 0 ? _e : false;
        this.frameCapture = (_f = convertToBool(this.node.tryGetContext('frameCapture'))) !== null && _f !== void 0 ? _f : false;
        this.glacier = (_g = this.node.tryGetContext('glacier')) !== null && _g !== void 0 ? _g : 'DISABLED';
        if (this.glacier &&
            !['DEEP_ARCHIVE', 'DISABLED', 'GLACIER'].includes(this.glacier)) {
            throw new Error(`The 'glacier' context variable must be one of 'DEEP_ARCHIVE', 'DISABLED', or 'GLACIER'; found value was '${this.glacier}'.`);
        }
        this.hostedZoneId = this.node.tryGetContext('hostedZoneId');
        this.sendAnonymousMetrics = (_h = convertToBool(this.node.tryGetContext('sendAnonymousMetrics'))) !== null && _h !== void 0 ? _h : false;
        this.workflowTrigger = (_j = this.node.tryGetContext('workflowTrigger')) !== null && _j !== void 0 ? _j : 'VideoFile';
        if (this.workflowTrigger &&
            !['VideoFile', 'MetadataFile'].includes(this.workflowTrigger)) {
            throw new Error(`The 'workflowTrigger' context variable must either be 'VideoFile' or 'MetadataFile'; found value was '${this.workflowTrigger}'.`);
        }
    }
}
exports.ContextVariables = ContextVariables;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiX2NvbnRleHQtdmFyaWFibGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiX2NvbnRleHQtdmFyaWFibGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLHFDQUFxQztBQUVyQyxNQUFNLGFBQWEsR0FBRyxDQUFDLEtBQW1ELEVBQUUsRUFBRTtJQUM1RSxJQUFJLEtBQUssS0FBSyxTQUFTLElBQUksQ0FBQyxLQUFLLEVBQUU7UUFDakMsT0FBTyxJQUFJLENBQUM7S0FDYjtJQUNELFFBQVEsS0FBSyxFQUFFO1FBQ2IsS0FBSyxJQUFJLENBQUM7UUFDVixLQUFLLE1BQU0sQ0FBQztRQUNaLEtBQUssQ0FBQyxDQUFDO1FBQ1AsS0FBSyxHQUFHLENBQUM7UUFDVCxLQUFLLElBQUksQ0FBQztRQUNWLEtBQUssS0FBSztZQUNSLE9BQU8sSUFBSSxDQUFDO1FBQ2Q7WUFDRSxPQUFPLEtBQUssQ0FBQztLQUNoQjtBQUNILENBQUMsQ0FBQztBQU1GLE1BQWEsZ0JBQWlCLFNBQVEsR0FBRyxDQUFDLFNBQVM7SUFhakQsWUFBWSxLQUFvQixFQUFFLEVBQVUsRUFBRSxLQUE0Qjs7UUFDeEUsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztRQUVqQixJQUFJLENBQUMsc0JBQXNCLFNBQzNCLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLHdCQUF3QixDQUFDLG1DQUFJLFdBQVcsQ0FBQztRQUVqRSxJQUFJLElBQUksQ0FBQyxzQkFBc0IsS0FBSyxTQUFTLEVBQUU7WUFDN0MsTUFBTSxJQUFJLEtBQUssQ0FDYiw0REFBNEQsQ0FDN0QsQ0FBQztTQUNIO1FBRUQsSUFDRSxJQUFJLENBQUMsc0JBQXNCO1lBQzNCLENBQUMsQ0FBQyxVQUFVLEVBQUUsU0FBUyxFQUFFLFdBQVcsQ0FBQyxDQUFDLFFBQVEsQ0FDNUMsSUFBSSxDQUFDLHNCQUFzQixDQUM1QixFQUNEO1lBQ0EsTUFBTSxJQUFJLEtBQUssQ0FDYix3SEFBd0gsSUFBSSxDQUFDLHNCQUFzQixJQUFJLENBQ3hKLENBQUM7U0FDSDtRQUVELElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLENBQUM7UUFFeEQsSUFBSSxJQUFJLENBQUMsVUFBVSxLQUFLLFNBQVMsRUFBRTtZQUNqQyxNQUFNLElBQUksS0FBSyxDQUFDLGdEQUFnRCxDQUFDLENBQUM7U0FDbkU7UUFFRCxNQUFNLG9CQUFvQixHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUNoRCwyRkFBMkYsQ0FDNUYsQ0FBQztRQUVGLElBQUksb0JBQW9CLElBQUksb0JBQW9CLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUM3RCxNQUFNLElBQUksS0FBSyxDQUNiLHFIQUFxSCxJQUFJLENBQUMsVUFBVSxJQUFJLENBQ3pJLENBQUM7U0FDSDtRQUVELElBQUksQ0FBQywyQkFBMkIsU0FDOUIsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsNkJBQTZCLENBQUMsbUNBQUksS0FBSyxDQUFDO1FBRWxFLElBQUksQ0FBQyxnQkFBZ0I7WUFDbkIsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsa0JBQWtCLENBQUMsS0FBSyxTQUFTO2dCQUN2RCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsMkJBQTJCO29CQUNqQyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsS0FBSyxTQUFTO29CQUNuRCxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsa0JBQWtCLENBQUM7b0JBQzdDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxDQUFDLFdBQVcsRUFBRSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFDLEVBQUU7Z0JBQzNHLENBQUMsQ0FBQyxTQUFTLENBQUM7UUFFaEIsSUFBSSxDQUFDLGtCQUFrQixTQUNyQixhQUFhLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxtQ0FBSSxLQUFLLENBQUM7UUFFeEUsSUFBSSxDQUFDLFNBQVMsU0FDWixhQUFhLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLENBQUMsbUNBQUksS0FBSyxDQUFDO1FBRS9ELElBQUksQ0FBQyxTQUFTLFNBQ1osYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDLG1DQUFJLEtBQUssQ0FBQztRQUUvRCxJQUFJLENBQUMsWUFBWSxTQUNmLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUMsQ0FBQyxtQ0FBSSxLQUFLLENBQUM7UUFFbEUsSUFBSSxDQUFDLE9BQU8sU0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsbUNBQUksVUFBVSxDQUFDO1FBQ2hFLElBQ0UsSUFBSSxDQUFDLE9BQU87WUFDWixDQUFDLENBQUMsY0FBYyxFQUFFLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUMvRDtZQUNBLE1BQU0sSUFBSSxLQUFLLENBQ2IsNEdBQTRHLElBQUksQ0FBQyxPQUFPLElBQUksQ0FDN0gsQ0FBQztTQUNIO1FBRUQsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUU1RCxJQUFJLENBQUMsb0JBQW9CLFNBQ3ZCLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLG1DQUFJLEtBQUssQ0FBQztRQUUxRSxJQUFJLENBQUMsZUFBZSxTQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBQyxtQ0FBSSxXQUFXLENBQUM7UUFFMUQsSUFDRSxJQUFJLENBQUMsZUFBZTtZQUNwQixDQUFDLENBQUMsV0FBVyxFQUFFLGNBQWMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLEVBQzdEO1lBQ0EsTUFBTSxJQUFJLEtBQUssQ0FDYix5R0FBeUcsSUFBSSxDQUFDLGVBQWUsSUFBSSxDQUNsSSxDQUFDO1NBQ0g7SUFVSCxDQUFDO0NBQ0Y7QUEvR0QsNENBK0dDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgY2RrIGZyb20gJ0Bhd3MtY2RrL2NvcmUnO1xuXG5jb25zdCBjb252ZXJ0VG9Cb29sID0gKHZhbHVlOiBzdHJpbmcgfCBib29sZWFuIHwgTnVtYmVyIHwgbnVsbCB8IHVuZGVmaW5lZCkgPT4ge1xuICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCB8fCAhdmFsdWUpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgY2FzZSB0cnVlOlxuICAgIGNhc2UgJ3RydWUnOlxuICAgIGNhc2UgMTpcbiAgICBjYXNlICcxJzpcbiAgICBjYXNlICdvbic6XG4gICAgY2FzZSAneWVzJzpcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29udGV4dFZhcmlhYmxlc1Byb3BzIHtcblxufVxuXG5leHBvcnQgY2xhc3MgQ29udGV4dFZhcmlhYmxlcyBleHRlbmRzIGNkay5Db25zdHJ1Y3Qge1xuICBwdWJsaWMgcmVhZG9ubHkgYWNjZWxlcmF0ZWRUcmFuc2NvZGluZzogc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgYWRtaW5FbWFpbDogc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgY2xvdWRGcm9udERvbWFpbjogc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgZW5hYmxlTWVkaWFQYWNrYWdlOiBib29sZWFuO1xuICBwdWJsaWMgcmVhZG9ubHkgZW5hYmxlU25zOiBib29sZWFuO1xuICBwdWJsaWMgcmVhZG9ubHkgZW5hYmxlU3FzOiBib29sZWFuO1xuICBwdWJsaWMgcmVhZG9ubHkgZnJhbWVDYXB0dXJlOiBib29sZWFuO1xuICBwdWJsaWMgcmVhZG9ubHkgZ2xhY2llcjogc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgaG9zdGVkWm9uZUlkOiBzdHJpbmc7XG4gIHB1YmxpYyByZWFkb25seSBwcmVwZW5kRG9tYWluV2l0aFN0YWNrU3RhZ2U6IGJvb2xlYW47XG4gIHB1YmxpYyByZWFkb25seSBzZW5kQW5vbnltb3VzTWV0cmljczogYm9vbGVhbjtcbiAgcHVibGljIHJlYWRvbmx5IHdvcmtmbG93VHJpZ2dlcjogc3RyaW5nO1xuICBjb25zdHJ1Y3RvcihzY29wZTogY2RrLkNvbnN0cnVjdCwgaWQ6IHN0cmluZywgcHJvcHM6IENvbnRleHRWYXJpYWJsZXNQcm9wcykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCk7XG5cbiAgICB0aGlzLmFjY2VsZXJhdGVkVHJhbnNjb2RpbmcgPVxuICAgIHRoaXMubm9kZS50cnlHZXRDb250ZXh0KCdhY2NlbGVyYXRlZFRyYW5zY29kaW5nJykgPz8gJ1BSRUZFUlJFRCc7XG5cbiAgICBpZiAodGhpcy5hY2NlbGVyYXRlZFRyYW5zY29kaW5nID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYFRoZSAnYWNjZWxlcmF0ZWRUcmFuc2NvZGluZycgY29udGV4dCB2YXJpYWJsZSBpcyByZXF1aXJlZC5gXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgIHRoaXMuYWNjZWxlcmF0ZWRUcmFuc2NvZGluZyAmJlxuICAgICAgIVsnRElTQUJMRUQnLCAnRU5BQkxFRCcsICdQUkVGRVJSRUQnXS5pbmNsdWRlcyhcbiAgICAgICAgdGhpcy5hY2NlbGVyYXRlZFRyYW5zY29kaW5nXG4gICAgICApXG4gICAgKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBUaGUgJ2FjY2VsZXJhdGVkVHJhbnNjb2RpbmcnIGNvbnRleHQgdmFyaWFibGUgbXVzdCBiZSBvbmUgb2YgJ0RJU0FCTEVEJywgJ0VOQUJMRUQnLCBvciAnUFJFRkVSUkVEJzsgZm91bmQgdmFsdWUgd2FzICcke3RoaXMuYWNjZWxlcmF0ZWRUcmFuc2NvZGluZ30nLmBcbiAgICAgICk7XG4gICAgfVxuXG4gICAgdGhpcy5hZG1pbkVtYWlsID0gdGhpcy5ub2RlLnRyeUdldENvbnRleHQoJ2FkbWluRW1haWwnKTtcblxuICAgIGlmICh0aGlzLmFkbWluRW1haWwgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgJ2FkbWluRW1haWwnIGNvbnRleHQgdmFyaWFibGUgaXMgcmVxdWlyZWQuYCk7XG4gICAgfVxuXG4gICAgY29uc3QgYWRtaW5FbWFpbFZhbGlkYXRpb24gPSB0aGlzLmFkbWluRW1haWwubWF0Y2goXG4gICAgICAvXltfQS1aYS16MC05LVxcXFwrXSsoXFxcXC5bX0EtWmEtejAtOS1dKykqQFtBLVphLXowLTktXSsoXFxcXC5bQS1aYS16MC05XSspKihcXFxcLltBLVphLXpdezIsfSkkL2dcbiAgICApO1xuXG4gICAgaWYgKGFkbWluRW1haWxWYWxpZGF0aW9uICYmIGFkbWluRW1haWxWYWxpZGF0aW9uLmxlbmd0aCAhPT0gMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgVGhlICdhZG1pbkVtYWlsJyBjb250ZXh0IHZhcmlhYmxlIG11c3QgYmUgYSB2YWxpZCBlbWFpbCBhZGRyZXNzIGFuZCBtdXN0IGNvbnRhaW4gb25seSBvbmUgZW1haWw7IGZvdW5kIHZhbHVlIHdhcyAnJHt0aGlzLmFkbWluRW1haWx9Jy5gXG4gICAgICApO1xuICAgIH1cblxuICAgIHRoaXMucHJlcGVuZERvbWFpbldpdGhTdGFja1N0YWdlID1cbiAgICAgIHRoaXMubm9kZS50cnlHZXRDb250ZXh0KCdwcmVwZW5kRG9tYWluV2l0aFN0YWNrU3RhZ2UnKSA/PyBmYWxzZTtcblxuICAgIHRoaXMuY2xvdWRGcm9udERvbWFpbiA9IFxuICAgICAgdGhpcy5ub2RlLnRyeUdldENvbnRleHQoJ2Nsb3VkRnJvbnREb21haW4nKSAhPT0gdW5kZWZpbmVkXG4gICAgICAgID8gIXRoaXMucHJlcGVuZERvbWFpbldpdGhTdGFja1N0YWdlICYmXG4gICAgICAgICAgdGhpcy5ub2RlLnRyeUdldENvbnRleHQoJ3N0YWNrU3RhZ2UnKSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgPyB0aGlzLm5vZGUudHJ5R2V0Q29udGV4dCgnY2xvdWRGcm9udERvbWFpbicpIFxuICAgICAgICAgIDogYCR7dGhpcy5ub2RlLnRyeUdldENvbnRleHQoJ3N0YWNrU3RhZ2UnKS50b0xvd2VyQ2FzZSgpfS4ke3RoaXMubm9kZS50cnlHZXRDb250ZXh0KCdjbG91ZEZyb250RG9tYWluJyl9YFxuICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICBcbiAgICB0aGlzLmVuYWJsZU1lZGlhUGFja2FnZSA9XG4gICAgICBjb252ZXJ0VG9Cb29sKHRoaXMubm9kZS50cnlHZXRDb250ZXh0KCdlbmFibGVNZWRpYVBhY2thZ2UnKSkgPz8gZmFsc2U7XG4gIFxuICAgIHRoaXMuZW5hYmxlU25zID1cbiAgICAgIGNvbnZlcnRUb0Jvb2wodGhpcy5ub2RlLnRyeUdldENvbnRleHQoJ2VuYWJsZVNucycpKSA/PyBmYWxzZTtcblxuICAgIHRoaXMuZW5hYmxlU3FzID1cbiAgICAgIGNvbnZlcnRUb0Jvb2wodGhpcy5ub2RlLnRyeUdldENvbnRleHQoJ2VuYWJsZVNxcycpKSA/PyBmYWxzZTtcblxuICAgIHRoaXMuZnJhbWVDYXB0dXJlID1cbiAgICAgIGNvbnZlcnRUb0Jvb2wodGhpcy5ub2RlLnRyeUdldENvbnRleHQoJ2ZyYW1lQ2FwdHVyZScpKSA/PyBmYWxzZTtcblxuICAgIHRoaXMuZ2xhY2llciA9IHRoaXMubm9kZS50cnlHZXRDb250ZXh0KCdnbGFjaWVyJykgPz8gJ0RJU0FCTEVEJztcbiAgICBpZiAoXG4gICAgICB0aGlzLmdsYWNpZXIgJiZcbiAgICAgICFbJ0RFRVBfQVJDSElWRScsICdESVNBQkxFRCcsICdHTEFDSUVSJ10uaW5jbHVkZXModGhpcy5nbGFjaWVyKVxuICAgICkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgVGhlICdnbGFjaWVyJyBjb250ZXh0IHZhcmlhYmxlIG11c3QgYmUgb25lIG9mICdERUVQX0FSQ0hJVkUnLCAnRElTQUJMRUQnLCBvciAnR0xBQ0lFUic7IGZvdW5kIHZhbHVlIHdhcyAnJHt0aGlzLmdsYWNpZXJ9Jy5gXG4gICAgICApO1xuICAgIH1cblxuICAgIHRoaXMuaG9zdGVkWm9uZUlkID0gdGhpcy5ub2RlLnRyeUdldENvbnRleHQoJ2hvc3RlZFpvbmVJZCcpO1xuXG4gICAgdGhpcy5zZW5kQW5vbnltb3VzTWV0cmljcyA9XG4gICAgICBjb252ZXJ0VG9Cb29sKHRoaXMubm9kZS50cnlHZXRDb250ZXh0KCdzZW5kQW5vbnltb3VzTWV0cmljcycpKSA/PyBmYWxzZTtcblxuICAgIHRoaXMud29ya2Zsb3dUcmlnZ2VyID1cbiAgICB0aGlzLm5vZGUudHJ5R2V0Q29udGV4dCgnd29ya2Zsb3dUcmlnZ2VyJykgPz8gJ1ZpZGVvRmlsZSc7XG5cbiAgICBpZiAoXG4gICAgICB0aGlzLndvcmtmbG93VHJpZ2dlciAmJlxuICAgICAgIVsnVmlkZW9GaWxlJywgJ01ldGFkYXRhRmlsZSddLmluY2x1ZGVzKHRoaXMud29ya2Zsb3dUcmlnZ2VyKVxuICAgICkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgVGhlICd3b3JrZmxvd1RyaWdnZXInIGNvbnRleHQgdmFyaWFibGUgbXVzdCBlaXRoZXIgYmUgJ1ZpZGVvRmlsZScgb3IgJ01ldGFkYXRhRmlsZSc7IGZvdW5kIHZhbHVlIHdhcyAnJHt0aGlzLndvcmtmbG93VHJpZ2dlcn0nLmBcbiAgICAgICk7XG4gICAgfVxuXG5cblxuXG5cblxuXG5cblxuICB9XG59Il19